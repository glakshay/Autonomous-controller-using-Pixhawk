% Initialisation for Google Earth Plugin
global h
 
% Customizing the figure window
hFig = figure(1);
set(hFig,'Name','Google Earth Plugin','Toolbar','none','Menubar','none','Position',[100,100,800,600])
hFig = figure(1);
 
cood = [ 0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231230000000   0.109224940000000   5.697156860000000;
   0.484231240000000   0.109224980000000   5.697156860000000;
   0.484231260000000   0.109225050000000   5.697156860000000;
   0.484231270000000   0.109225120000000   5.697156860000000;
   0.484231290000000   0.109225200000000   5.697156860000000;
   0.484231320000000   0.109225300000000   5.697156910000000;
   0.484231360000000   0.109225480000000   5.697157630000000;
   0.484231410000000   0.109225690000000   5.697161530000000;
   0.484231470000000   0.109225930000000   5.697174400000000;
   0.484231540000000   0.109226210000000   5.697206270000000;
   0.484231610000000   0.109226520000000   5.697271230000000;
   0.484231700000000   0.109226860000000   5.697386810000000;
   0.484231720000000   0.109226970000000   5.697430900000000;
   0.484231720000000   0.109226970000000   5.697430900000000;
   0.484231810000000   0.109227350000000   5.697775960000000;
   0.484231840000000   0.109227480000000   5.698040690000000;
   0.484231840000000   0.109227480000000   5.698040690000000;
   0.484231950000000   0.109227900000000   5.699629949999999;
   0.484232060000000   0.109228350000000   5.702419819999999;
   0.484232170000000   0.109228820000000   5.706433960000000;
   0.484232290000000   0.109229320000000   5.711695610000000;
   0.484232420000000   0.109229850000000   5.718227120000000;
   0.484232550000000   0.109230390000000   5.726049560000000;
   0.484232690000000   0.109230960000000   5.735182390000000;
   0.484232830000000   0.109231540000000   5.745643230000000;
   0.484232970000000   0.109232140000000   5.757447729999999;
   0.484233120000000   0.109232760000000   5.770609470000000;
   0.484233270000000   0.109233390000000   5.785139999999999;
   0.484233430000000   0.109234030000000   5.801048860000000;
   0.484233590000000   0.109234690000000   5.818343670000000;
   0.484233750000000   0.109235360000000   5.837030240000000;
   0.484233910000000   0.109236040000000   5.857112689999999;
   0.484234080000000   0.109236730000000   5.878593510000000;
   0.484234250000000   0.109237430000000   5.901473930000000;
   0.484234420000000   0.109238140000000   5.925754380000000;
   0.484234590000000   0.109238860000000   5.951434910000000;
   0.484234770000000   0.109239590000000   5.978515540000000;
   0.484234950000000   0.109240340000000   6.006996279999999;
   0.484235130000000   0.109241090000000   6.036877140000000;
   0.484235320000000   0.109241850000000   6.068158130000000;
   0.484235500000000   0.109242630000000   6.100839260000000;
   0.484235690000000   0.109243410000000   6.134920530000000;
   0.484235880000000   0.109244200000000   6.170401970000000;
   0.484236080000000   0.109245010000000   6.207283580000000;
   0.484236280000000   0.109245820000000   6.245565370000000;
   0.484236470000000   0.109246650000000   6.285247340000000;
   0.484236680000000   0.109247480000000   6.326329519999999;
   0.484236880000000   0.109248330000000   6.368811910000000;
   0.484237090000000   0.109249190000000   6.412694520000000;
   0.484237300000000   0.109250050000000   6.457977370000000;
   0.484237510000000   0.109250930000000   6.504660450000000;
   0.484237720000000   0.109251820000000   6.552743789999999;
   0.484237940000000   0.109252720000000   6.602227390000000;
   0.484238160000000   0.109253620000000   6.653111259999999;
   0.484238330000000   0.109254340000000   6.693655699999999;];
cood=cood*100;
 
% Creating COM server
h = actxcontrol('Shell.Explorer.2', [0 0 800 600]);
 
% Open Google Earth Plugin Host
invoke(h,'Navigate2',strcat(pwd,'\pluginhost3.html'));
 
% Wait until the Document finished loading
while strcmp(h.Document.title,'Google Earth Plugin - Ready')~=1
    pause(0.01)
end
   
 h.Document.parentWindow.execScript(['UpdateCamera(' num2str(48.423123045697500) ',' ...
                                                    num2str(10.922493539400300) ',' ...
                                                    num2str(469.7156861096700) ',' ...
                                                    num2str(70) ',' ...
                                                    num2str(90) ',' ...
                                                    num2str(0) ');'] , 'JavaScript');
                                               
pause(3);
 
for i=1:65
 h.Document.parentWindow.execScript(['tickAnimation(' num2str(cood(i,1)) ',' ...
                                                    num2str(cood(i,2)) ',' ...
                                                    num2str(cood(i,3)) ',' ...
                                                    num2str(70) ',' ...
                                                    num2str(90) ',' ...
                                                    num2str(0) ');'] , 'JavaScript');
 
pause(0.02)                                              
end